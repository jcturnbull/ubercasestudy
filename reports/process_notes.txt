## idea generation:
<some notes here>

## data notes

get weather data
cross-check daily precipitation amounts against online sources
realize precipitation start conditions are double counted within hourly block observations
cross-check again to verify precipitation
realize data is in UTC -> could pose a problem for TLC data (idk the format yet)
some missing data, mostly in february.
for the presentation: show / link photos together showing my progression to verifying the data, with Dec 31 2024 as the example for rainfal that evening.
raw -> ID right codes -> sum hourly to cross-check with 24h -> compare against online data. inch/mm conversion.

tlc data
in local time, with daylight savings applied.
well, mostly. some 02:00-am hour information for march 9th, which is incorrect, obviously.
DST fixed.
sometimes the congestion fee (old one) is 5.50, which doesnt make sense. this happened 3x in 20m datapoints in march, and each time the congestion fee doubled. discarded.
sometimes driver pay is negative - this corrects when tolls are paid back and tips are included, with a floor (at least in march) or 0.0. Discarded.
base fare is sometimes negative, i guess this is hvfhv eating the cost for market share or retention reasons
discard negative miles, negative trip time, and negative tips
full discard list:
- negative or missing wait time
- invalid congestion surcharges
- invalid CBD fee
- negative driver pay
- negative miles
- negative trip_time
- negative tips
- temporal ordering violations

LGA has roughly 2-3mm pax a month
JFK has double, somewhere in the 6mm ballpark
-> 1.5mm laguardia pickups + dropoffs in march seems reasonable?
-> great market penetration, perhaps limited growth from new riders, but reliable passengers might be committed and be more inelastic

choose to look at request_hour buckets, not pickup, because we primarily want to measure demand from riders to measure weather impacts.

## eda
after merging the data, did exploratoy data analysis, such as plotting variables over time and correlations of variables.
laguardia curfew 12am-6am. drop 2-6 hours, which is all rides after 1:59:59 and before 07:00:00, so probably can drop those from the modeling dataset
shaded Friday 19:00 (5pm) → Monday 06:00 (6am) - weekend color.

## seasonality
Seasonality adjustment is mandatory if you want a clean estimate of weather’s causal impact rather than confounding patterns like:
- Airport demand surges during AM/PM peaks
- Friday evening + Sunday evening spikes (airport return patterns)
- Monthly travel cycles
- Holiday travel patterns
- Day-of-week business travel norms
- Summer tourism vs winter lull
If you don’t remove or model these, your regression will attribute normal seasonal variation to weather, inflating or deflating your weather coefficients.
note: I like holiday flags, but we should be extremely specific, maybe we can save this for later. pocket it as a potential limitation or enhancement.

## metrics
ignoring median for fares, for now. average is probably good over the large dataset. i could always get the summary statistics. 
i could always include distributions into the appendix of these metrics.
port authority published how many people flew through 8 months through LGA/EWR/JFK here https://www.panynj.gov/port-authority/en/press-room/press-release-archives/2025-press-releases/port-authority-airports-soar-to-busiest-month-ever-with-all-time.html
so can measure uber/lyft penetration, somewhat, but not totally, as not all uber/lyfts are TLC at EWR pickup. So we can get a lower bound.

## hypotheses
1. more extreme wind_chill_diff (wind chill - temp) leads to more demand on an hour-of-the-week basis
2. heat index diff (heat index - temp) " "
3. rainfall also, regressing on rainfall amount, and binaries rain_flag and heavy_rain. expect more rain to have more demand.
then move on to average base fare in the same conditions. this is to target the "how to make money"
theory: Uber could charge more for faster trips as part of a value-add proposition during slower periods, when people still want comfort
new hypothesis: next-hour demand depends on current hour's rain, ex: my chicago trip was delayed but no rain when i landed. crowded airport.

## prelim results
- each 1 deg F that wind chill falls below air temp, hourly demand increases by 2.4 trips, after seasonality adjustments. colder than expected results in more trips
- heat index is 2.1 trips per hour per additional head-index higher than temp, but not statistically significant. note: way fewer heat index hours than wind chill (1787 vs 514)
- For each additional 1 mm of precipitation per hour, seasonality-adjusted demand at LGA drops by ~10–11 trips.
- ground stops, arrival reductions, diversions, and cancellations could lead to fewer planes landing thus fewer passengers to request rides. the true effect might be a relative increase compared to arriving passengers, but i don't have that data
- airport ride demand depends on planes, not weather, at the end of the day. slow arrivals suppress ride volume. i hadn't really considered this. perhaps better effects will show up on a fare basis for Uber, to show higher willingness to pay. enhancement: internal data of price check vs booked rides in the rain.
- when i talked to people about this, they said "of course rain causes more ubers!" so this seems to be the counterintuitive result, at least based on current data.
- Any rain at all reduces LGA hourly demand by ~54 rides after removing seasonality. (binary flag)
- Heavy rain slashes LGA hourly demand by ~140 rides relative to normal conditions due to operational slowdowns.
- Rain’s effects peak with a 1-hour delay, potentially consistent with the operational response of arriving flights.
- Heavy rain produces massive demand deficits (~100+ rides), again strongest (but barely) one hour later.
- quadratic testing, wind chill no meaningful result, heat index same, precipitation had significant but extremely small impact, interpretable as no clear evidence of quadratic relationship. this makes sense as demand is arrival constrained moreso than preference influenced.
- heat mechanism has no real effect
- wind chill has noticeable effect, both on absolute and relative basis

## MLR
Demand: demand_resid ~ wind_chill_f+heavy_rain_flag_lag0+precip_lag0
- this means colder conditions increase Uber demand at LGA, about 0.8 trips per degreee fahrenheit drop in wind chill (comfort effect)
- every additional mm/hr of rainfall reduces hourly demand by 53 trips (operational intensity effect)
- while precip captures all marginal negative effects on demand, the heavy flag now captures the baseline shift in the regime. this means that once intensity is accounted for to include operational reasons, there's actually increased demand in heavier rain periods than baseline (as expected intuitively), because the marginal suppresion of demand is fully absorbed by precipitation intensity.
- Increasing rainfall intensity drives the negative demand impact; once we control for that, the heavy-rain regime adds a small positive baseline shift, reflecting behavioral factors rather than operational severity.
Economics
- example date of 2025-03-20, total margin E1 estimate is better than E0. This shows actually Uber probably can't improve pricing in rainy, cold weather.
- “Given the data I had, I find limited incremental monetization from weather-aware pricing, because Uber already appears to be internalizing most of the weather effect.”

## limitations and enhancements
- get historical data on an hourly basis for average temp on an hour-level for every day of the year to compare the current temp vs baseline. no time now.
- vacation flags. noticed Sunday 1/19 before MLK Jr holiday, demand was down. probably looked more like a saturday than a typical sunday. can show the chart here.
- further enhancement: rain's impact on manhattan travel.
- enhancement: internal data of price check vs booked rides in the rain.
- Rain intensity is sparse; heavy-rain regressions rely on low sample. heavy_rain flag is only 28 hours, for example. rain flag is 385. total precip is 695.9. verified against daily summary (692.404, close enough with rounding from 27.26 inches)
- no supply data, so hard to verify root cause of margin effects
- hours with rain and wind chill is 145
- count of rain in consecutive hours is 263
- count of rain in consecutive hours with wind chill in the current hour is 113, not big
- did not see how much changing the threshold for heavy rain changes the estimated coefficient or the direction. perhaps heavy rain should be higher than 5mm per hour. moderate rain is 2.5-7.5mm/h, and 7.6mm+ is heavy, i split the difference of moderate rain to binary classify rather than three options.
- since month is a residualization variable (alongside hour of the week), temperature could become partially redundant
- nonlinear cross terms
- enhancement: If driver_pay_pct_of_base_fare predicts fare_resid, Uber’s pricing is reacting to driver supply constraints.
- no out of sample testing done, or bootstrapping, etc.
- no OLS testing done, like heteroskedasticity, autocorrelation, stationarity, etc.
- limitation: i don't have instantaneous demand, the best i could do without using future data was lag1 demand.

## presentation ideas
clickbait title, answered by "no" (probably) ex: can Uber raise airport fares?
describe the value proposition Uber offers (safety, comfort, etc)
present alternatives to Uber (MTA)
frame approach (i wanted to look at this because xyz, e.g. it's personal to me)
present results
briefly present upside / risks of this (e.g. XX YYY is the head of airports)
briefly present challenges (data gathering, verification) and enhancments - things I didn't do
...
then have backup slides for all the details, in the appendix
what data i used
every single type of challenge for weather and verification
challenges of tlc data, and what i threw out to look at (and how many).
note: look at how many lga rides are impacted by my discard rules (not many, on a relative basis, i bet, but i need the number, maybe even by category)
what i thought about metrics-wise, and what i didn't end up using

maybe work in the paper about comparing prices, note even my mom talked to me about this from the news. could be anecdotal evidence for Uber being able to raise rates (most don't compare).
probably need uber market share for that, though.